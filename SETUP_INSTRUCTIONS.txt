PeekX - Quick Look Extension Setup Instructions
==============================================

IMPORTANT: Follow these steps to add the Quick Look extension to your Xcode project.

Step 1: Add Quick Look Extension Target
----------------------------------------
1. Open PeekX.xcodeproj in Xcode
2. Click on the project in the navigator (blue PeekX icon at top)
3. At the bottom of the targets list, click the "+" button
4. Search for "Quick Look Extension"
5. Select "Quick Look Extension" and click "Next"
6. Configure the extension:
   - Product Name: "PeekX QuickLook" (no space)
   - Team: Select your development team
   - Language: Swift
   - Click "Finish"
7. When asked "Activate 'PeekX QuickLook' scheme?", click "Activate"

Step 2: Replace Extension Files
--------------------------------
1. In the Project Navigator, find the "PeekX QuickLook" folder that Xcode created
2. Delete the following files Xcode generated (Move to Trash):
   - PreviewProvider.swift (we'll use our custom one)
   - Any other .swift files in the extension folder
3. In Finder, navigate to: /Users/barathwajanandan/Documents/mac_apps/PeekX/PeekX QuickLook/
4. Drag these files into the "PeekX QuickLook" group in Xcode:
   - PreviewProvider.swift
5. Replace the Info.plist:
   - Delete the Info.plist in the "PeekX QuickLook" group (if any)
   - Drag the Info.plist from Finder into the "PeekX QuickLook" group

Step 3: Add Shared Files to Both Targets
-----------------------------------------
1. In Finder, navigate to: /Users/barathwajanandan/Documents/mac_apps/PeekX/Shared/
2. Drag SharedSettings.swift into your Xcode project
3. When the dialog appears, make sure BOTH targets are checked:
   ☑ PeekX
   ☑ PeekX QuickLook
4. Click "Finish"

Step 4: Configure App Groups (CRITICAL for settings sync)
----------------------------------------------------------
1. Select the PeekX project (blue icon)
2. Select the "PeekX" target
3. Go to "Signing & Capabilities" tab
4. Click "+ Capability"
5. Add "App Groups"
6. Click "+" under App Groups
7. Enter: group.com.peekx.shared
8. Check the box next to it

9. Now select the "PeekX QuickLook" target
10. Go to "Signing & Capabilities" tab
11. Click "+ Capability"
12. Add "App Groups"
13. Click "+" under App Groups
14. Enter: group.com.peekx.shared (same as above)
15. Check the box next to it

Step 5: Configure Bundle Identifiers
-------------------------------------
1. Select the "PeekX" target
2. Go to "General" tab
3. Bundle Identifier should be: com.yourteam.PeekX (or similar)

4. Select the "PeekX QuickLook" target
5. Go to "General" tab
6. Bundle Identifier should be: com.yourteam.PeekX.PeekX-QuickLook
   (It should be the main app's identifier + .PeekX-QuickLook)

Step 6: Build and Run
----------------------
1. Select the "PeekX" scheme (not "PeekX QuickLook")
2. Build and run (Cmd+R)
3. The main app will open with the settings interface

Step 7: Enable the Extension
-----------------------------
1. Open System Settings (System Preferences)
2. Go to Privacy & Security → Extensions
3. Click on "Quick Look" in the left sidebar
4. Enable "PeekX QuickLook"

Step 8: Test It!
----------------
1. Open Finder
2. Navigate to any folder
3. Select the folder
4. Press the Space bar
5. You should see the enhanced PeekX preview with:
   - Folder statistics
   - File type breakdown
   - Recent files
   - Largest files

Troubleshooting
---------------

Problem: Extension doesn't appear in System Settings
Solution: Make sure both targets are signed with the same team/certificate

Problem: Settings don't sync between app and extension
Solution: Verify App Groups are configured correctly and use the same identifier

Problem: Extension shows generic preview
Solution: 
- Make sure the extension is enabled in System Settings
- Check that Info.plist has "public.folder" in QLSupportedContentTypes
- Try restarting Finder: Option-Right Click Finder icon → Relaunch

Problem: Build errors
Solution: 
- Clean build folder (Shift+Cmd+K)
- Make sure SharedSettings.swift is added to both targets
- Check that all imports are correct

What You've Built
-----------------

✅ Main App (PeekX)
   - Beautiful settings interface
   - Toggle options for different preview sections
   - Sliders to control how many files to show
   - Instructions for users
   - Button to open extension settings

✅ Quick Look Extension (PeekX QuickLook)
   - Intercepts folder previews
   - Analyzes folder contents
   - Shows statistics, file types, recent files, largest files
   - Beautiful HTML preview with gradient design
   - Respects user settings from the main app

✅ Shared Settings
   - Settings sync between app and extension via App Groups
   - Configurable options:
     * Show/hide hidden files
     * Show/hide file types
     * Show/hide recent files (with count slider)
     * Show/hide largest files (with count slider)

Next Steps
----------
- Customize the colors/design in PreviewProvider.swift (HTML section)
- Add more statistics or preview options
- Add file icons or thumbnails
- Support for specific file type filtering
- Add app icon in Assets.xcassets

Need Help?
----------
If you encounter issues, check:
1. Console logs in Xcode when running the extension
2. System logs: Console.app → filter for "PeekX"
3. Extension installation: qlmanage -m in Terminal
